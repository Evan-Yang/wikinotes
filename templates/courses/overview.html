{% extends "base.html" %}

{% block content %}
<div class="container">
	<section>
		<h1>{{ course.department.short_name }} {{ course.number}} <small>{{ course.name }}</small></h1>
		<div class="row">
			<div class="span12">
				<ul class="unstyled">
					<li><strong>Description:</strong> {{ course.description }}</li>
					<li><strong>Credits:</strong> {{ course.credits }}</li>
					{% if current_sem %}
						{% if current_sem.professors.count %}<li><strong>Current professor{{ current_sem.professors.count|pluralize }}:</strong> {{ current_sem.professors.all|join:", " }}</li>{% endif %}
						{% if current_sem.readings %}<li><strong>Readings:</strong> {{ current_sem.readings }}</li>{% endif %}
						{% if current_sem.readings %}<li><strong>Evaluation:</strong> {{ current_sem.evaluation }}</li>{% endif %}
					{% endif %}
				</ul>
				<h2>Browse by page type</h2>
				{% if all_pages %}
				<div class="row">
					<div class="span2 columns">
						<strong>Semesters</strong>
						<ul class="unstyled">
							{% for page_type in page_types %}
							<li>{{ page_type.long_name }}</li>
							{% endfor %}
						</ul>
					</div>
					<div class="span10 columns">
						{% comment %} JS fallback, as always ... the things I do {% endcomment %}
						{% for page_type in page_types %}
							<h5>{{ page_type.long_name }}</h5>
							{% include page_type.list_template %}
						{% endfor %}
					</div>
				</div>
				<p>Filter by semester: lol</p>
				{% else %}
				<p>There are no pages associated with this course! Why not try adding some?</p>
				{% endif %}
				<h2>Other resources</h2>
				<ul class="unstyled">
					<li><a href="http://www.docuum.com/McGill/{{ course.department.short_name }}/{{ course.number }}">{{ course }} on Docuum</a></li>
					<li><a href="http://www.mcgill.ca/study/2011-2012/courses/{{ course.department.short_name }}-{{ course.number }}">{{ course }} in the McGill course listings</a></li>
				</ul>
				{% include "pages/create_popup.html" %}
			</div>
			<div class="span4 columns" id="right-bar">
				<div class="row" style="margin-bottom: 0px;">
				{% if user.is_authenticated %}
				<form method="post" action="{{ course.get_url }}/watch">
				{% csrf_token %}
				{% endif %}
					<div class="half-column">
						<p><a href="#create-page-popup" class="btn info" id="create-page-button">New page</a></p>
						<p><strong>Pages:</strong> {{ course.num_pages }}</p>
					</div>
					<div class="half-column">
							<p><input type="submit" class="btn" value="{% if is_watching %}Unwatch{% else %}{% if user.is_authenticated %}Watch{% else %}Login first{% endif %}{% endif %}" /></p>
							<p><strong>Watchers:</strong> {{ course.num_watchers }}</p>
					</div>
				{% if user.is_authenticated %}
				</form>
				{% endif %}
				</div>
				<hr />
				<div class="row">
					<div class="half-column icon-thumb">
						<p><a href="{{ course.department.get_url }}"><img src="{{ course.department.get_image }}" alt="{{ course.department.short_name }}" title="{{ course.department }}" /></a></p>
						<p>{{ course.department }}</p>
					</div>
					<div class="half-column icon-thumb">
						<p><a href="{{ course.department.faculty.get_url }}"><img src="{{ course.department.faculty.get_image }}" alt="{{ course.department.faculty }}" title="{{ course.department.faculty }}" /></a></p>
						<p>{{ course.department.faculty }}</p>
					</div>
				</div>
				<h4>Recent activity</h4>
				<ul class="unstyled">
				{% if course.latest_activity %}
				{% for item in course.recent_activity %}
					<li>{{ item.user }} {{ item.action }} {% if item.page %}{{ item.page }}{% else %}this course{% endif %}</li>
				{% endfor %}
				<li><a href="{{ course.get_url }}/recent">View all recent changes &raquo;</a></li>
				{% else %}
				<li>Nothing has happened recently for this course. Boo.</li>
				{% endif %}
				</ul>{% comment %} lol it's better than p{% endcomment %}
			</div>
		</div>
	</section>
</div>
{% endblock %}
